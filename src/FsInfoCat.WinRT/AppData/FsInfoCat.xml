<?xml version="1.0" encoding="utf-8" ?>
<FsInfoCat>
    <Init>
        <Command>
            <![CDATA[CREATE TABLE IF NOT EXISTS "CrawlConfigurations" (
    "Id" UNIQUEIDENTIFIER NOT NULL COLLATE NOCASE,
    "DisplayName" NVARCHAR(1024) NOT NULL CHECK(length(trim("DisplayName"))=length("DisplayName") AND length("DisplayName")>0) COLLATE NOCASE,
    "MaxRecursionDepth" UNSIGNED SMALLINT NOT NULL DEFAULT 128,
    "MaxTotalItems" UNSIGNED BIGINT CHECK("MaxTotalItems" IS NULL OR "MaxTotalItems">0) DEFAULT NULL,
    "TTL" BIGINT CHECK("TTL" IS NULL OR "TTL">299) DEFAULT NULL,
    "StatusValue" UNSIGNED TINYINT NOT NULL CHECK("StatusValue"<8) DEFAULT 0, -- CrawlStatus.NotRunning
    "LastCrawlStart" DATETIME DEFAULT NULL,
    "LastCrawlEnd" DATETIME DEFAULT NULL,
    "NextScheduledStart" DATETIME DEFAULT NULL,
    "RescheduleInterval" BIGINT CHECK("RescheduleInterval" IS NULL OR "RescheduleInterval">899) DEFAULT NULL,
    "RescheduleFromJobEnd" BIT NOT NULL DEFAULT 0,
    "RescheduleAfterFail" BIT NOT NULL DEFAULT 0,
    "Notes" TEXT NOT NULL DEFAULT '',
    "CreatedOn" DATETIME NOT NULL DEFAULT (datetime('now','localtime')),
    "ModifiedOn" DATETIME NOT NULL DEFAULT (datetime('now','localtime')),
    "UpstreamId" UNIQUEIDENTIFIER DEFAULT NULL COLLATE NOCASE,
    "LastSynchronizedOn" DATETIME DEFAULT NULL,
    --  "RootId" UNIQUEIDENTIFIER CONSTRAINT "FK_CrawlConfiguration_Root" REFERENCES "Subdirectories"("Id") ON DELETE RESTRICT COLLATE NOCASE,
    CONSTRAINT "PK_CrawlConfigurations" PRIMARY KEY("Id"),
    CHECK((("UpstreamId" IS NULL AND "LastSynchronizedOn" IS NULL) OR ("UpstreamId" IS NOT NULL AND "LastSynchronizedOn" IS NOT NULL)) AND "CreatedOn"<="ModifiedOn")
)]]>
        </Command>
    </Init>
</FsInfoCat>
